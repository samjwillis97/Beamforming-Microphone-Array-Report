 
 
       
   


equationsection

   























language=Matlab,
    basicstyle=,
    keywordstyle=,
    
    commentstyle=,
    stringstyle=,
    numberstyle=,
    
    basewidth=0.5em

1    
MECH4841 Part B 
2019   
FYP Report - Acoustic Beamforming Array 

Proof of Concept Design of an Acoustic Beamforming Microphone Array for the Early Detection of Defects 
  

Final Year Project Report - MECH4841 Part B  
June 2020
[UoNMCHA]Samuel Willis
[UoNMCHA]
Student of Mechanical Engineering,

The University of Newcastle, Callaghan, NSW 2308, AUSTRALIA 

Student Number: 3256767 

E-mail: mailto:s.willis@uon.edu.aus.willis@uon.edu.au


Dot Point Summary
    
        Developed a simulation package for beamforming array algorithms and geometries.
        Designed and built a working beamforming array.
        Implemented a time-domain and frequency-domain algorithm for beamforming.
        Demonstrated the acoustic array differentiating between two different simultaneous sound sources using the MUSIC algorithm.
        Tested the acoustic array on in-service turbines for the purpose of locating unknown sound sources.
    
Final Year Project Part B - COVID19 Impact Statement
    The University of Newcastle understands that the Covid 19 Pandemic may have negatively affected students in different ways during 2020.

    In the spirit of fairness, the Discipline of Mechanical, Mechatronic and Aerospace systems Engineering invite students to disclose any issues that may have affected the progress and outcome of their final year program. These issues will be taken under considerations when assessing your project.
    
    Issues may include, but are not limited to:
    
    financial/employment and accommodation issues.
    
    Illness and or death of a loved one, impact of caring for loved ones and dependants (including home schooling.)
    
    Difficulty accessing laboratory space, equipment and or specialist computer software.
    
    Other.


Abstract

    
    
    
    
    
    
    
    
    
    Locating defects and fault on plant can be difficult when a problem cannot be confidently diagnosed or located,
    now with the high availability of MEMS Microphones due to the ever-increasing demand of smartphones acoustic arrays consisting of large quantities of MEMS microphones have been made much more achievable without huge capital outlays. An array consisting of a large number of MEMS Microphones allows for the beamforming of incoming signals and the locating of unknown sound sources. 
    
    The core aims of this project were to design and build an acoustic array consisting of up to 48 microphones that would be able to locate individual unknown sound sources from within a noisy environment for the purpose of locating defects in machinery by employing two different algorithms, the delay-and-sum and MUltiple SIgnal Classification (MUSIC). Once satisfied to be working the aim was to evaluate the performance of the acoustic array in detecting defects on in-service machinery in an industrial environment.
    
    The final array consisted of 24 microphones and proved to differentiate and locate multiple sound sources in a noisy environment using the MUSIC algorithm with ease, this algorithm allowed for the ability to target either a specific frequency or set of frequencies to spatially search for, easily differentiating sound sources. In the limited on-site testing at a local power station the array was unable to determine the location of any noises present on an in-service turbine due to the harsh sound environment, though with further on-site testing and software refinement this array should be able to locate machine defects as it has shown in the lab environment.





Nomenclature
Latin Alphabet
    
        
    
    Greek Alphabet
    
        
    

Introduction     
    Beamforming is a technique where an array of sensors can be steered towards a particular direction either for transmission of signals or for the locating of signal sources.
    
    The cocktail party effect, a phenomenon that relies on the human ability of being able to focus on one particular sound or voice when there are multiple other sources of noise, competing sources and distractions. This was first investigated in 1953 by Colin Cherry, what he referred to as the cocktail party problem, asking the question, can we replicate the ability of the cocktail party effect with man-made systems? This is the problem beamforming microphone arrays aims to solve.
    
    For the purpose of this project beamforming is applied with an array of microphones being used to locate a sound source. Beamforming acoustic arrays are not a new concept, they have been used extensively in aerocoustics for the purpose of analysing aerofoils of aeroplanes and wind turbines for characterising and measuring generated noise as well as applications in finding the source of gas leaks, source of reverberation and general noise in studio environments, and finding squeaks and rattles in the automotive industry. One notable array is from a collaboration between Hyundai Motor Group and SM Instruments who together developed a small real-time acoustic array for the purpose of finding squeaks and rattles in Hyundai car's this array is available for purchase but costs upwards of 65'000, though it's not suited for the purpose of early detection of defects on machinery especially as it can only beamform between the frequencies of 2kHz and 8kHz. The purpose of this project is to design an acoustic array to locate the sources of potential early defects in machinery for condition monitoring and analysis of plant.
    

Literature Review 
Acoustic Beamforming     Through the digital processing of multiple signals received at microphones at known locations an estimated direction of arrival and location of a signal of interest can be found, this is the basic concept of acoustic beamforming. This process can be performed in either the time-domain or the frequency-domain by using different algorithms and processing techniques. One of the core assumptions for all algorithms is whether the audio waves are treated as far-field or near-field. The far-field assumption treats the sound waves as a planar wave-front while the near-field assumption treats sound waves as a spherical wave front. Sound waves can be assumed to be far-field when they have propagated such that Equation  is true, before this they are treated as near-field, this is due to point sources producing a spherical wave-front and as it propagates becoming planar, a general rule of thumb can also be applied here, where far-field starts approximately 2 wavelengths from the sound source. 
    
    
    
            
        
    For the purpose of acoustic beamforming an array of microphones are used where the exact coordinate of each and every microphones is known and usually constant, the received signal at each sensor can then be synchronised, digitized and processed through a choice of algorithms and output the spatial location of a source of interest or audio from that point. This process involves using the known propagation speed of sound waves in air and the time difference of arrival for the signals at each one of the sensors.
    
    The geometry of the microphone array and the quantity of sensors becomes important for the accuracy and resolution of the estimated signal location. The choice of geometry arrangement whether it be in a grid, straight line or any other design can cause problems at particular frequencies due to spatial aliasing this will be further explained in Section , this requires careful consideration when designing the geometry of the microphone array, thus the frequencies of interest must be defined beforehand to determine the required microphone array design and size. These frequencies are particularly important for choosing the diameter of the microphone array (also known as the aperture) and the microphone spacing for grid and straight line arrays.
    
    Considerable amounts research and design have been achieved in the area of microphone array geometries, due to this several different array designs have been devised in attempt to increase the resolution and accuracy by decreasing the width of the main-lobe whilst avoiding spatial aliasing and minimising side-lobe levels as is discussed further in Section . Some of the best performing and most popular array designs are shown in Figure . These are regarded as some of the best performing due to them all having a high resolution with a high signal to noise ratio over a broad range of frequencies.
    
        
                        
            Microphone Array Designs.
                            

Digital Signal Processing     The processing of digital signals is the most important factor when it comes to beamforming, as an array of only two microphones have the potential to perform beamforming to a certain degree of accuracy, whilst improving the signal condition, signal processing, and choice of algorithm, the resulting accuracy can be improved.
    
    An analog signal is defined as a continuous signal that varies over time where the varying value in electronics is often voltage, for example the output of the microphones used throughout this project is a analog signal with a varying voltage between  50mV. Sampling of an analog signal is one of the core processes of digital signal processing, this is the process of discretization allowing the signal to be defined by a finite set of values. When sampling the signal it must be ensured that it is being sampled at a high enough rate to avoid aliasing, this is distortion that occurs when the reconstructed signal differs from the original due to not sampling at a high enough rate. This occurs when a signal is sampled at less than half of its the frequency, this required sampling rate is known as the Nyquist Rate. When sampled below the Nyquist Rate the audio waves are not able to be recreated accurately. This concept is best explained with a visualisation, Figure  shows one sine wave sampled at three different rates, from this we can see how if the sampling rate is equal to the frequency of the signal it esults in a constant amplitude whilst sampling at other frequencies below the Nyquist Rate will results in completely different signal with varying frequencies and amplitudes. 

    
                        Nyquist Rate Visualised
                
    The concepts of a Nyquist rate and aliasing is directly related to Spatial Aliasing, this must be taken into account when designing microphone arrays. Spatial Aliasing occurs when the the location of the signal source cannot be determined due to the spacing of sensors in the microphone array relative to the wavelength of the signal of interest. This is similar to sampling and normal aliasing but rather than the points being sampled on the sine wave as being the problem its the spatial location of the microphones hence "spatial" aliasing. For example a Hz signal will have a wavelength of cm shown by Equation , therefore if you have sensors spaced this distance apart it's not possible to tell exactly what direction the Hz signal is originating from, this can be explained as if you were to picture a signal at its peak at the first microphone it will also be at the peak for the second microphone, and therefore appear exactly the same, this is because they are exactly one wavelength apart, very similar to what is shown in Figure . For sensor arrays in a uniform line or grid the sensors must have a spacing of less than half the wavelength of the maximum frequency of interest to avoid spatial aliasing. An appropriately sized aperture is another important property of array geometry, the aperture is the diameter of the array and a larger aperture is required to beamform low frequency signals.
	
	
	
            
        

Fourier Transform 
    The Fourier transform is a vital part of digital signal processing, especially for analysis of vibration signals and condition monitoring, as well as a requirement for beamforming in the frequency-domain. A Fourier Transform is used to change a signal from the time-domain to the frequency-domain. A signal in the time domain consists of a series of amplitudes with corresponding time-stamps, Fourier transforming will result in the signal being broken up into the individual frequencies that make up that signal, where each frequency is essentially a sinusoidal wave that have an individual amplitude and phase. Figure  shows how a Fourier transform will break down a square wave signal, the red pane shows the original signal in the time-domain, the blue pane on the right shows the signal Fourier transformed spectrum, and in the middle we can see the actual individual waveforms the signal can be broken down into, this visualization allows us to see the frequency composition and the differing phases and amplitudes for each frequency.
    
    
                        Fourier Transform Visualization.
                
    The discrete Fourier transform is defined by Equation , the core operation of the Fourier transform is the dot product. Performing a dot product of two equal length signals would be the equivalent multiplying them element by element and summing the result. The dot product result can be thought of as similarity, as the dot product of a sinusoidal wave and cosine wave of the same frequency will be 0, whilst two sinusoidal waves of the same frequency will be a maximum and two sinusoidal waves 180 degrees out of phase will be a negative maximum. 
    
    
        *
    
    When performing a Fourier transform on a finite length signal the resolution of the Fourier transform depends on the length and sampling rate of the digitized signal, due to this we have frequency bins which is the resolution of the Fourier transform and therefore frequency spectrum, if the spectrum begins at 0 and the frequency bin size is 4Hz this would mean all of the frequencies from 0 to 4Hz would essentially be summed into the single bin at 4Hz, and frequencies from 4 to 8Hz would be in the 8Hz bin and so on. From Eqn.  we define  as the number of samples in a signal and  as a frequency bin, as the output of a discrete Fourier Transform is a series of frequency bins. Each one of the  output frequency bins corresponds to a particular frequency that can be calculated with Equation , the result when  is the size of the frequency bins.
    
    
    
    As can be determined by Equation  the resolution of the discrete Fourier Transform relies on the amount of time of the signal is processed, 1 second signal will have 1Hz frequency bins whilst 0.25 second signal will have 4Hz frequency bins and hence the frequencies within the 4Hz range will be effectively summed together into each frequency bin.
    

Delay-and-Sum Beamformer     The Delay-and-Sum algorithm is the classical method of beamforming in the time-domain and one of the most robust and well used. As the location of each sensor in the array is known and we know that sound waves propagate at the speed of sound, we can determine that a distant sound source of will arrive at each sensor at a slightly different time this is the time difference of arrival that is calculated with the array geometry and is the core of all methods beamforming.
    
    The name of this algorithm comes from the processes undertaken, consisting of two main steps; delaying and summing. First the signal from each sensor is individually shifted by a time delay that corresponds to a particular spatial location relative to the sensor, the signals are then summed to receive the resulting waveform from that location this process is digitally steering the microphone array. Once the resulting signal is divided through by the number of sensors we have attenuated and amplified the signal at the angle of interest and dulled signals from all other locations as they will not interfere constructively. This concept is visually demonstrated in Figure , showing how the angle of interest is attenuated in comparison to all other angles being dulled.
    
    
                        Delay-and-Sum Beamforming Diagram.
            
Frequency-Domain Beamformer     Delay-and-Sum beamforming is performed in the time-domain as the signal is a function of amplitude and time, there are other algorithms that are used in the time-domain based off of delay-and-sum theory, though there are several other algorithms that process in the frequency-domain. Beamforming in the frequency-domain involves analysing the signals by their amplitudes of individual frequency bins without respect to time but to the signal as a whole and therefore must be over a set period of time. 
    
    A conventional frequency-domain beamformer requires the incoming signal to be in the Fourier-domain which is achieved by performing a Fourier transform as described in Section . Compared to the time-domain delay-and-sum beamformer where the signal is delayed by shifting/delaying the times of the incoming signals the frequency-domain differs, the signal is delayed by adding a phase delay to the individual frequency bins that are a result of the Fourier transform, this theoretically achieves the same result as the delay-and-sum beamforming but has the advantage of being far less computationally intensive and potentially have far greater accuracy in results..


MUSIC Algorithm     The MUltiple SIgnal Classification algorithm (MUSIC) is a subspace frequency-domain method of beamforming relying upon an eigen-decomposition of the spatial co-variance matrix of the received signal data. The spatial co-variance matrix is decomposed into it's eigenvalues and vectors that are then sorted by eigenvalue and separated into noise and signal subspaces.
    With the use of array steering vectors based on phase rather than time, the direction of arrival can be estimated as the steering vector is theoretically orthogonal to the noise subspace obtained from eigenvalue decomposition and therefore when multiplied together results in 0, when taking the reciprocal of this it will tend towards infinity when at the angle of the sound source similar to what is seen in Figure . This results in a high resolution algorithm for estimating the direction of arrival of either narrowband or wideband signals and far less computationally heavy compared to the traditional Delay and Sum beamforming algorithms. Below in Figure  a comparison of the two algorithms is shown for the purpose of demonstrating the additional resolution and accuracy gained. 

    

    
                        MUSIC and Delay and Sum Comparison.
                

    Condition Monitoring     "Condition monitoring is the continuous monitoring of rotating machines during process conditions. This ensure the optimal use of machines. Condition Monitoring supports predictive maintenance, which is more efficient than preventive maintenance. Condition Monitoring provides insight in performance, wear and mechanical risks of machines. This helps to prevent unnecessary and unplanned downtime."Ist.
    
    Preventive maintenance of machinery is the regular replacement of components based on a rigid schedule and the typical operating life expectations resulting in parts being replaced or lubricated more often than necessary to meet these requirements resulting in inefficient use of valuable time. With the introduction of electronic instrumentation allowing vibration analysis and potentially acoustic analysis these preventive maintenance programs can be easily converted to predictive maintenance programs. Predictive maintenance uses data from measurements and other analysis performed on a regular basis, the concept is to predict when it is necessary to take the machine out of service for maintenance and/or repair rather than waiting for the machine to breakdown and require fixing, this leads to an effective and efficient maintenance program.
    
    Condition Monitoring is part of the maintenance program though relates more to a particular machine. Condition Monitoring aims to define the current condition of a machine by comparing it to previously known conditions. Analysing the trends of this allows for the prediction of machine condition over time. Through the use of an acoustic array that could potentially be permanently setup the condition of the machine can be easily monitored and any changes or particular noises will be able to be analysed individually or montioring could be done on a routine basis to analyse trends in the machinery sound-scape.

Aims and Objectives 
Problem     Currently the condition monitoring of rotating machinery is primarily performed using vibration, proximity and temperature sensors. This is generally performed on a schedule with routine data analysis for insight into any trends or patterns indicating machinery may need additional maintenance or repair. If this machine in the mean-time starts to make odd noises from an unknown location it can be a lengthy and expensive process to determine where it is coming from and why. With an acoustic array set up in-front of machinery it is possible to monitor a large area for any changes in sound or appearance of problem noises and therefore will be able to identify where the problem has arisen from, even further it will be possible to analyse the noise further and potentially diagnose the problem. This could potentially save a great amount of time and money especially if other techniques require machinery to be taken out of service for analysis.

Use of Microphone Arrays for Condition Monitoring     Currently there are few acoustic arrays that have been built for the purpose of condition monitoring, they have been shown to be a powerful tool with serious potential in an article on the analysis of electric motors with an acoustic camera. There is one acoustic technology company "Squarehead Technology" that offer condition monitoring acoustic arrays as one of their services in the USA and Norway but besides this there is a large gap in the market of acoustic arrays purpose built for condition monitoring especially for outright purchase. With the ability to choose how the algorithms are processing the incoming data it will give the ability to pinpoint the locations of individual machine defects through the known fault frequencies and harmonics.

Project Aim     By the completion of my final year project I aim to have a completely functioning acoustic array. This array should be able to determine when a noise of interest is present, locate it spatially and return a clean signal for further analysis. The current milestones are as follows:
    
    
        Learn about audio signal processing and developed a greater understanding.
        Develop an understanding of condition monitoring, vibration analysis and its applications.
        Learn LabVIEW and Develop a greater understanding of data acquisition and software development.
        Develop a simulation environment for quick and easy testing of array geometries and beamforming algorithms.
        Implement a working algorithms in both the time and frequency domain and show it working in simulation.
        Build an acoustic array using NI Hardware and MEMS Microphone.
        Demonstrate a working acoustic array able to locate and detect sound sources.
        Demonstrate the acoustic array picking particular sounds out of noisy environments.
        Extract the signal from point of interest for further analysis.
        Test the acoustic array on site on operating machinery.
        
    With a working acoustic array it will allow for the optimisation of the maintenance and monitoring for a large range of machinery improving the financial costs, time and safety as well as analysis for early detection of defects and locating of unknown sources of noises.

Software Research and Development 
    LabVIEW by National Instruments was the chosen environment for software development and data acquisition. This choice was made due to the integration with National Instruments' Hardware that was readily available for the purpose of this project. 
    
    LabVIEW is short for Laboratory Virtual Instrument Engineering Workbench, a programming environment in which you create programs graphically connecting function blocks with wires for data flow. LabVIEW features a graphical user-interface making it simple for simulations, presentation of ideas and general programming. With the inbuilt digital signal processing and data acquisition libraries this makes LabVIEW incredibly useful for the purpose of developing an acoustic array.

Delay-and-Sum Algorithm     To begin a full investigation into acoustic beamforming arrays a complete understanding of the delay-and-sum beamformer is required. For explanation and ease of understanding it is best to think of a uniform linear array of  microphones (sensors). Figure  demonstrates a uniform linear array, where  is an unknown sound source impinging on the array from the far-field as a planar wavefront,  is the incoming incident angle of the unknown source,  is the spacing between sensors,  is additive noise and interference from the environment,  is the signal at each sensor, and  the output of each of these sensors.
    
    
                        Uniform Linear Array of Microphone Array.
                
    As can be seen in the diagram, the path to each microphone has slightly differing lengths, this is what causes the differing time delays and allows for beamforming as it is the fundamental reason beamforming is possible. If we let  be the received signal at the origin then an array of signals received at each sensor at time instant  is written as seen in Eqn  and  will be the signal received at sensor :
    
    
    
    
    In Equation , , is the time delay, also known as the time difference of arrival, as it is the difference in time for the signal to reach microphone  relative to a reference microphone or the centre of the array. For arrays of any geometry this delay can be quite easily calculated using trigonometry, the speed of sound, and location of the sensors. It should always be taken into account that the speed of sound in air will change with the temperature, , this relationship is shown in Equation . 
    
    
    
    For the uniform linear array we can find the delay for each microphone using the respective  locations relative to the origin at the centre of the microphone array and the Equation .
    
    
    
    This can be modified for 2D planar arrays so that it takes into account the  and  location  relative to the origin at the centre of the microphone array, by using Equation , this will allow the use of any array of microphones, including the arrays pictured in Figure .
    
    
    
    Both Equation  and  make the assumption of, the azimuth () being the angle sweeping across horizontally in-front of the array ranging from  where  is at the origin and the elevation () sweeping from the bottom at  to the top at  vertically. This co-ordinate system is used to digitally steer the beam over a virtual area in-front of the array to determine where a signal is coming from by iterating through all combinations of azimuth and elevation. The point in-front of the array where the signal has the highest equivalent power is the estimation of the signal source's location.
    
    Using this delay-and-sum algorithm will also allow for the extracting of signals from a particular spatial location by applying the algorithm to a single spatial point rather. For the point of interest the channels are delayed accordingly, summed and then divided by the number of microphones to return a single waveform for the location of interest.

LabVIEW Implementation     For the real implementation of the delay-and-sum algorithm the delay equation needs a minor modification due to the digital sampling of signals. For instance when a signal is sampled at kHz known as the sample rate (), the time between each sample is approximately ms, now we have to work in discrete time steps of this sample length rather than continuous time, therefore the delay formula is re-written as shown in Equation  to take this into account.
    
    
    
    A problem arises using Equation  when the calculated delay for a particular channel is not an integer, due to the digital sampling the smallest delay is the sample length as it is not possible to delay by sub-sample time steps. When using a lower sampling rate this problem can cause large inaccuracies, the easiest way to prevent this is to use the highest possible sample rate to minimise the error, otherwise, the incoming signal can be up-sampled by a preset factor using a Linear Up-sampler or Finite Impulse Response Filter, this up-sampling factor is taken into account with the delay by multiplying the original sampling rate by this same factor. 
    
    The process in LabVIEW for applying the delay to each signal was to find the largest and the smallest delay required for that particular point, then for each channel the absolute value of the smallest delay for that point plus the individual channel delay worth of zeroes are added to the beginning of the signal as padding. Following this, the absolute value of the largest delay of samples are removed from this signal to ensure there are no zeroes left in the signal to keep signal integrity. The LabVIEW code for this process is shown in Figure , as can be seen LabVIEW code is closer to a block-diagram than traditional text-based programming languages. The two rectangular structures in Figure  are For Loops, the outer loop iterates through a larger 2D array of delays and returns a 1D array of delays for a particular azimuth and elevation, the inner loop iterates through a 1D array of each channel applying the correct delay channel by channel.
    
    
                        LabVIEW Delay Block Diagram Data Flows Left to Right
                
    To produce a heat-map of the location of sounds in-front of the acoustic array the array is digitally steered to each point on a virtual grid in-front of the array and the equivalent power of the signal at this point is evaluated then plotted. For the delay-and-sum beamformer this process involves going through each azimuth and elevation giving a grid 180 by 180 points representing the area in-front of the array and delaying and summing at each point. The analog signals once digitized are converted to an array of floating point values where each index is an individual sample of amplitude, then for each point on the array the signal is to be delayed by the calculated amount using Equation , then an equivalent power at each point is calculated as a single number, using Equation , this produces a 2D array that is plotted as an intensity or heat-map.
   
    
    *
    
    Equation  determines the power at a single point by summing all the channels at that point resulting in a single signal wave that has been either constructively and destructively interfered then divided by the number of channels normalising the resulting waveform, an example of this can be seen in Appendix . Now the single interfered waveform is squared element-by-element, this process makes all values positive but also attenuates the peaks of the signal relative to the troughs. Finally each amplitude value for every sample of the wave is summed together resulting in a single value for that point. This process makes sure positions with larger amounts of constructively interfered signals that are closer to the signal location are attenuated further and return a higher value allowing for a heat-map to be created with the estimated signal source location. So that the heatmap could be easily interpreted the output 2D array of power of the grid is re-scaled between 1 and -1 for easy interpretation therefore if the value for a location is 1 it is the most likely estimation of the location of the signal of interest.
    

MUSIC Algorithm     This section has been adapted from Direction of Arrival Estimation and DOA Estimation based on MUSIC algorithm for this project. When approximating the direction of arrival of signals using the multiple signal classification algorithm the anticipated data for the  arriving signals are modeled as below in Eqn. .
    
    

     is a  array consisting of a series of steering vectors for the M impinging signals.  is a vector of the narrowband signals impinging on the array that consists of each signals amplitude and phase.  is a vector consisting of the noise received at each of the microphones which is assumed to be a zero-mean Gaussian distribution with a co-variance of .

    
    
    Where:
    
    
    
    An assumption is made that the impinging signals are uncorrelated, and therefore the estimated correlation of matrix of  is as shown in Eqn. , in this  represents the expected value and  is the notation used to indicate a hermitian or conjugate transpose of the array. A conjugate transpose involves transposing the array and also taking the conjugate of the complex conjugate of all values.
    
    
    where
    
    
    
     is the signal co-variance matrix, an  array that has rank . When performing eigen-decomposition of the signal co-variance matrix  it results in  eigenvalues and eigenvectors, there are  eigenvalues and corresponding vectors that span the noise subspace , and  spanning the signal subspace .
    The eigenvalues and corresponding vectors are then sorted in descending order of eigenvalue. The  eigenvalues that should be equal to  are the eigenvalues that span the noise subspace and those eigenvalues corresponding vectors create the matrix . If we let  be one of the eigenvectors corresponding to the noise subspace we can show,
    
    

    This implies that the noise eigenvectors are orthogonal to the  steering vectors and is the basis of the MUSIC algorithm. Where orthogonal vectors are those whose dot product equals , if plotted in 2D these would be perpendicular.
    
    Once the noise subspace matrix  has been determined the MUSIC pseudo spectrum of power can be calculated as a function of  and  as shown in Eqn. , as shown above due to the fact that the noise eigenvectors are orthogonal to the steering vectors when the the azimuth and elevation are that of the impinging signal and therefore Eqn.  will get exponentially larger as the correct location for the signal is found.
    
    


LabVIEW Implementation     When implementing the MUSIC algorithm in LabVIEW I started with the narrowband MUSIC approach where it is assumed the signal only contains a single frequency  the same as is outlined in Section .
    
    Firstly the complex phase delays for each microphone in the array were generated for every combination of elevation and azimuth in front of the array. These were calculated using equations  and .
    
    
    
    *
    
    Next the correlation matrix is calculated for , the true value is not able to be calculated and must be estimated, the estimation is made using the received data from the microphone array, this is performed by averaging the result over several snapshots of data as can be seen in Eqn.  the rule of thumb is that  for the number of averages required, by performing averaging it allows for a more accurate representation of the noise and signal subspace. 
    
    

    
    To get the value for  the length of the incoming signals from each array in samples is determined, the signal for each channel is then divided into  equal snapshots of equal length. A Fourier transform is performed for each snapshot for each channel and the value of the complex spectrum for the particular narrowband frequency  is returned for each channel and snapshot. As the signal is being broken up into  snapshots the returned value for the complex spectrum may not be only for the narrowband of  and rather will be the value for the closest frequency bin to the frequency  as was outline in Section .
    
    Now with  vectors of , the correlation matrix can be calculated for each snapshot and then averaged, this gives an estimation for the real correlation matrix.
    
    Once the correlation matrix has been estimated eigenvalue decomposition is performed. This returns  eigenvalues, and eigenvectors, these are sorted in descending order and split into the signal and noise subspace. The  eigenvectors corresponding to the  smallest eigenvalues the matrix , in the software implementation of MUSIC the  eigenvalues should be the smallest and all roughly equal. Now applying Eqn.  the direction of arrival for the  signals can be determined by the peaks in the equation. 
    
    Below Figure  and  show the LabVIEW block diagrams of one of my implementation of the MUSIC algorithm, in particular wideband MUSIC through a given range of frequencies. Figure  shows the process of iterating through each channel and then for each snapshot the complex spectrum value is calculated as well as the microphone delay matrix.
    
    
                        LabVIEW MUSIC Implementation Block Diagram Pt.1
                
    Figure  shows the calculating of the correlation matrix for each snapshot, the averaging of this, the eigen-decomposition of the estimated correlation matrix over the  snapshots and the calculation of the MUSIC power spectrum following the process that has been described above.

    
                        LabVIEW MUSIC Implementation Block Diagram Pt.2
                
    When applying the MUSIC algorithm to a wideband signal instead of a single frequency there will almost definitely be multiple frequencies all belonging to the same frequency bin, if the algorithm was to iterated through every single frequency and solve this would increase the computational effort required dramatically as it could be required to iterate through hundreds of unnecessary frequencies. To reduce the computational requirements the size of the frequency bins of the Fourier transform for each snapshot are calculated using the following Eqn.  where  is the number of samples in the full signal.
    
    
    
    Once the size of the frequency bins are established the wideband frequency range is then divided by the bin size to determine how many iterations/FFTs are required as then rather than iterating through each individual required frequency, iterations are done by frequency bin. For each frequency bin the full narrowband compute as described above is calculated and the resulting power for each frequency at each point is averaged to calculate the estimated direction of arrival of the  wideband signals.
    
    Identical to the 2D array of power returned by the delay-and-sum the MUSIC algorithm returns a value for each spatial location using equation  which is normalised between -1 and 1, again with 1 being the most likely location of the signal of interest to allow direct comparison to the delay-and-sum algorithm and easy interpretation of results. The one downside of MUSIC compared to the delay-and-sum algorithm the MUSIC algorithm does not actually resolve a resultant signal at each location and therefore cannot be used to extract signal without the help of delay-and-sum. 
    
    Another very useful implementation of the MUSIC algorithm is using a select number of pre-determined frequencies to perform the average over for rather than a range, this is particularly useful when locating machine defects as covered in greater detail in Section , as well as being a more accurate way to locate defects it is much more computationally efficient than calculating the power array for all of the frequency bins in a range.
    

Simulation Package     
    
    To ensure all implementations of beamforming algorithms perform as intended and for the purpose of testing all changes to algorithms and ideas relatively quickly I built a simulation package that would be able to simulate any number of different spatial signals and additional noises for any chosen microphone array geometry rather than having to setup a real test environment with an array and data acquisition.
    
    This simulation package was designed with the purpose of being as flexible as possible and adding as many features as required while designing the array and testing algorithms throughout the software design phase of the project. The following sections outline the primary functions of the simulation package including the Array Generator, Delay Calculator, Spatial Signal Generator, and File Playback.
    

Delay Calculations     At the core of all beamforming algorithms is the relative delays between each microphone for an impinging signal. This function shown in Figure  applies Eqn.  and , by taking in the microphone array in Cartesian co-ordinates and generating an array of delays relative to the first microphone for a signal arriving at a particular Azimuth and Elevation.
    
    
                        Microphone Relative Delay Generator LabVIEW Block Diagram
                
    
    By iterating through this function for every single combination of Azimuth and Elevation a 3 dimensional array of delays is produced for, this includes the time or sample delay of every microphone for a signal coming from all possible combinations of Azimuth and Elevation in front of the microphone array. This function is at the core of all beamforming algorithms and simulations for recreating spatial signals.
    

Array Generator     The first required function of the simulation package was to be able to generate microphone array geometry or import them from a file. The array generator I developed has options to generate a uniform linear array, grid array, circular array or an under-brink array for the purpose of quickly generating any number of different array geometries. Figure  shown below is of the LabVIEW block diagram for the array generator.
    
    
                        Array Generator LabVIEW Block Diagram
                
    The LabVIEW block diagram only shows a partial snippet of the program and is the function for generating a custom under-brink array. Starting from the left, it takes the inputs of Arms, Minimum Radius, Maximum Radius and Arm Angle. These are processed through a math-script function block to calculate both the radius and angle of each particular microphone as according to the equations presented in Section , once processed the values are converted from cylindrical co-ordinates to Cartesian co-ordinates. On the right hand side of the diagram is the outputs, the XY graph that is shown in Figure  and the array of Cartesian co-ordinate.
    
    Below in Figure  the user interface for the Array Generator is shown. As well as giving various options for array customisation a live plot of the current array is displayed on the right hand side of the user interface.  
    
    
                        Array Generator LabVIEW Front Panel User Interface
                

Spatial Signal Generator     Using the generated microphone array geometry and the generated array of microphone delays from Section  and  respectively equivalent spatial signals can be recreated for the purpose of simulating and testing microphone array performance. Figure  shows the block diagram of the LabVIEW VI that performs the signal generation. This VI can recreate up to two separate spatial signals, with added white noise and has a choice of equivalent sampling rate and the number of samples capture. This allows for a more accurate representation of array performance and especially for the ratio of processing time to signal length and the effects of the signal length on algorithm and array performance. 
    
    
                        Spatial Signal Generator LabVIEW Block Diagram
                
    
    The spatial signals are simulated by calculating what the phase delay would theoretically be for a signal coming from a given spatial location. For instance, to simulate a signal of frequency  that is coming from a an azimuth of  and elevation of  the phase can be calculated using Equation  by converting time in seconds to phase in degrees for said frequency. The phase delay is calculated for each microphone to generate a separate signals for each to simulate the real world situation.
    
    
    
    Figure  shows the user interface for the spatial signal generator, besides giving a way to choose the values it has aided with delay-and-sum algorithm development as it gives a way to visualise what perfectly delayed signals should look and therefore how the algorithm operates.
    
    
                        Spatial Signal Generator LabVIEW Front Panel User Interface
                


File Playback 
The file playback function was added as a convenient way to replay data from testing and also gives the ability to choose any section of the file to perform beamforming with and perform post-processing.

Figure  shows the user interface for playing back files, displaying the sound waves on the right and by zooming in on this plot different sections of the waveform can be used for processing.

    
                        File Playback LabVIEW Front Panel User Interface
              


Simulation Testing and Validation  
    
   With the spatial signal generator producing perfectly delayed signals. When this array of signals is input into any beamforming algorithm it ideally gives a performance gauge of the algorithm itself and the geometry of the array. When the output heat-map is compared against the 3D frequency response heat-map it is clear whether the results are as expected or not, Figure  demonstrates this. The white is the estimated location of the signal source going down to blue then black as the least likely.
    
    
                        
            Comparison of Simulation Results to Expected Results
                            
    Comparing the mathematical model used in the frequency response and the implemented delay-and-sum algorithm in the simulation both returned nearly the same results, this indicates that the delay-and-sum algorithm is working as intended and that the simulation works as intended as well. The two main side-lobs in Figure a can also be seen in Figure b towards the top left and bottom right for further verification. Additional Figures from this simulation are included in Appendix  
    

Algorithm Simulation Comparison 
    This section details the core differences found in simulating both the Delay-and-Sum Algorithm and the MUSIC Algorithm. Figure  shows the comparison of the two algorithms response to a single 1863Hz frequency signal at 13 Degrees to the left of centre Azimuth and 16 Degrees below the centre Elevation.
    
    
                
        DAS and MUSIC Algorithms compared at 1863Hz
                
    The differences between algorithms is very clear. To make the comparison as computationally fair as possible the input signals were of different lengths to make the compute time equal which begins to show the computational differences between the two. The input signals for MUSIC was 8 seconds long while the input signals for delay-and-sum was only 0.1 seconds. The MUSIC algorithm outperforms the delay-and-sum drastically, as it estimates the signal location to pin-point accuracy, the delay-and-sum's most likely estimation is only a few degrees off the real location, though looking at the estimation results it could realistically be anywhere within the 7 degree main-lobe size.
    
    Figure  shows a test of the ability of both algorithms to separate two signals of the exact same frequency. Two single frequency 1863Hz signals were produced both on the horizontal and 12 Degrees either side of the centre giving 24 Degrees of separation, 24 degrees was chosen as it was the smallest degree of separation that both algorithm could separate the signals. The same length of input signals was used as the previous example to keep it comparable. This test shows slightly different results but still the MUSIC algorithm performs better as it has a definite differentiation between the signals but the estimation of location of the left signal slightly above the real location, whilst the delay-and-sum has only just differentiated the signals but is giving a larger main-lobe area for the location estimations as well as having higher side-lobe levels across the range.

    
                
        DAS and MUSIC Algorithms compared at 1863Hz Source Separation
                
    Overall through extensive testing it was found that the delay-and-sum algorithm was a much more robust algorithm that does not need any user configuration but is essentially attempting to find the strongest sound source in its view which can lead to misleading results, as well as this it is much more computationally intensive compared to the MUSIC algorithm. The MUSIC algorithm performed with much higher accuracy, resolution and computational efficiency than the delay-and-sum algorithm in simulation showing great potential but does require more knowledge of the signal of interest with some user configuration for it to be effective as well as fast.
    

Hardware Research and Development 
2D Frequency Response     A Frequency response is a visual way of analysing the effectiveness of microphone array geometries to a certain frequency coming from particular directions and allows for a quick analysis of array geometries. A frequency response for a uniform linear array of 10 microphones with a spacing of cm subject to a 2kHz signal is pictured in Figure  and the same response when digitally steered to 130 in Figure .
    
    
                        2D Frequency Response
                
                        2D Frequency Response Steered to 130
                
    When evaluating a 2D Frequency response the main points of interest are the main-lobe, its beam-width and the side-lobes. The main-lobe is the lobe with the greatest amplitude seen at 90 in Figure  the beam-width is the width from where the main-lobe drops to -20dB as this is half the power of 0dB, this is effectively the resolution of the array at that frequency. side-lobes are important to show the effective gain of interference that appear to be coming from angles other than the angle of interest due to spatial aliasing, these can be seen in Figure  and  by the 7 or 8 lobes with peaks around -20dB gain. The goal of microphone array geometry design is to minimise the side-lobes minimizing interference, and decreasing the beam width to give a better array resolution.
    
    Equation  was adapted from and has been applied to calculate 2D Frequency responses in Figures  and .
    
    
    
     defined as the angle of arrival, where  is the location in the -direction from the origin, and  is the steered angle of the beamformer.
    
    Another useful visualisation using Equation  is a form of Frequency response that iterates the 2D Frequency response above through a range of frequencies, this makes it easier to spot if there are any problem frequencies due to the array geometry. Using the same array as Figure , Figure  shows the frequency response from Hz to kHz.
    
    
                        2D Frequency Response over Varying Frequencies
                
    Figure  demonstrates precisely how useful it can be for spotting problem frequencies for particular array geometries. We can see at around kHz another main-lobe begins, this will make it impossible to determine where the signal is truly coming from as it would seem as it is coming from all 3 directions, this is due to the microphone array sensor spacing being a multiple of the signal wavelength causing spatial aliasing to occur, creating misleading results. As can be calculated with Equation  just below 4kHz the wavelength is 8cm, exactly the same as the microphone spacing, hence the spatial aliasing.
    
    Another important property of this array is where it becomes use-able, before around Hz the array has no directionality and cannot determine the direction of a source of interest. The lack of directionality is due to the aperture of the array as mentioned in Section , at Hz the signal wavelength is roughly 80cm which is the aperture of the array, hence any frequency below this will have a wavelength greater than the aperture of the array and the array will not have directionality.
    
    2D Frequency Response analysis of microphone arrays is useful if the geometry of the array is symmetrical. The 2D Response is only looking at the angle of arrival across one of the axes, in this case the angle of arrival is moving across the array azimuth and therefore we cannot see the response of a signal moving across the elevation. For arrays that are symmetrical this doesn't matter as the response will be the same for both azimuth and elevation. A more useful analysis for non-symmetrical array geometry can be 3D Frequency Response.

3D Frequency Response     The 3D Frequency response is based on Equation  using a modified version of Equation , adding a way to analyse the  location of each microphone and its respective response due to that.
    
    
    
    The main difference between the equation for 2D and 3D Frequency Response is the added factor for the steering and response along the elevation so a response can be found for all spatial locations in front of the array. Figure (a), (b),  and are the results for a 3D Frequency response for a grid array with 16 Microphones, 4 rows, 4 columns with a row and column spacing of 8cm subject to a 2kHz signal and digitally steered towards the origin of the array.

    
                
        3D Frequency Responses
                
    Figure (a) and (b) are both 3D Frequency Responses from the same array with different scaling, the decibel scaling can be useful for a lot of analysis as it attenuates the side-lobes a lot more than a linear scale. These figures allow easy visualisation of the side-lobes and nulls that appear at any particular frequency, these are just a 3D representation of the heat-map in Figure , the heat-map is the most useful for visualising array performance due to the ease of interpretation.
    
    
                        3D Frequency Response Heatmap in Decibel
                
    When analysing an array geometry using a heat-map like the one pictured in Figure  the high points are in white going through blue to black at the lowest. This grid array in particular has 1 main-lobe pictured in the centre as the white area and 4 particularly high side-lobes on all sides of the main-lobe with nulls in between for the given frequency. This array shows a good response at this frequency but at different frequencies it is clear it will experience spatial aliasing with such prominent side-lobes. These side-lobes can also be clearly seen in Figure (a). The one drawback of the 3D Frequency response is only being able to analyse a single frequency at a time, this is where the 2D frequency response excels.


Geometry Design 
    The main constraints with the design of microphone array is the number of handle-able synchronised high sample-rate analog inputs.
    
    A comparison of various array geometries was performed by Zebb Prime and Con Doolan of The University of Adelaide, this included various spiral array geometries that were evaluated by comparing their minimum side-lobe levels and beam widths. A comparison of all the arrays for both near-field and far-field was presented but as the purpose of the array in this report is for far-field signals the near field results were not taken into account. The comparison showed the the Underbrink geometry design was overall the best performing closely followed by the Brüel  Kjær (BK) array. Hence for the choice of array for the proof of concept design the Underbrink array was chosen as it shows promising resolution and minimal side-lobes especially for the number of sensors being used.
    
    The Underbrink array is shown in Figure , it described as a "multi-spiral design where the microphones are placed in the centre of equal area segments". Where a minimum and maximum radius  and  respectively must be defined as well as the number of spiral arms  and microphones per spiral . This array is based upon the following set of equations.
    
    The radius of each individual microphone:
    
    *
    The angle of each individual microphone:
    
    *
    
    To be able to generate many different configurations of the Underbrink array a Python script was written, this script also converted the coordinates from polar to Cartesian exporting straight to a spreadsheet, making it easy to work with the LabVIEW Simulation package. As progression was made with LabVIEW this was converted to a LabVIEW module for better integration to the full simulation package. 

First Design     For the initial testing of microphone arrays and verification that it would be possible with the available hardware I designed an Underbrink array with an inner radius of 25mm and outer radius of 250mm, made up of 3 arms with 4 microphones each. The reason for 12 microphones was due to a hardware limit as there were only 12 available high speed analog input cards for data acquisition at the time. Through the initial design process it was found that the Underbrink array performed better when there was an odd number of arms as it prevent the array from being symmetrical and significantly reduced the side-lobe levels and spatial aliasing as is further investigated in Section , a plot of the designed array is pictured in .
    
    
                        Chosen Underbrink Array
                
    The choice of the inner and outer radius dimensions were based off of the frequency response and ease-of-building, giving very minimal side-lobe levels and a acceptable resolution between 1kHz and 4.5kHz without being overly large. Designs were considered with larger radii to have a better response at lower frequencies but for the current purpose of testing algorithms and whether the microphone array will actually work the frequency range is not required.
    
    Figure (a) and (b) show the frequency response for this custom Underbrink array at 2kHz, compared to the grid array shown in Section  the Underbrink shows very minimal side-lobe levels or obvious side-lobes and no spatial aliasing giving a promising response for the amount of sensors hence the choice for further testing.  

    
                
        Underbrink Array 3D Responses
                
    Below Figure  shows the array that was used in this first design, this was constructed from a sheet of cardboard as this allowed for easy prototyping of an array of this size, holes were cut at the exact location of the microphones which allowed for easy mounting with a screw and an additional hole made for the cables to be run through. The main problem with a design like this is the potential for reverberation noise from the solid back-plane of the array.
    
    
                        Initial Microphone Array
                

Second Design     For the second iteration of the microphone array my limit was increased to 48 synchronous analog channels. This was to be achieved using two separate National Instrument cRIO-9036's both filled with 8 NI-9232's capable of 3 analog channels sampling at 102.4kHz.
    
    The Figures for this section can be found in Appendix .
    
    Through an investigation of Underbrink array designs found that an odd number of arms performs better than an even number when using a similar number of microphones. This is found to be due to the symmetrical geometry produced by an even number of arms that causes the problem of spatial aliasing. The series of microphone array geometries used to demonstrate this are displayed in Appendix , these geometries range from 42 to 48 microphones being used and from 5 to 9 arms and all with a minimum radius of 25mm and maximum radius of 0.5m as this gave the best possible frequency response without the array becoming too large to easily move, carry and transport. The theoretical frequency response of an array of this size will be from 686Hz to beyond the 10kHz limit of the microphones.
    
    Appendix  features the 3D Frequency Response of each of the arrays from Appendix  when subject to a pure 4kHz signal at the absolute centre of the array. This demonstrates that purely having a greater number of microphones will not result in a better performing array and that other choices made with the geometry will see better improvements in performance. All of the geometries have a near identical beam-width, this was expected as the used 4kHz signal is well within all of their ideal frequency response range, and with all of the arrays having equal inner and outer radius' no array should have an advantage. Both microphone arrays utilising the full 48 microphones show significantly larger side-lobe levels than the arrays with less microphones due to the even number of arms on the array creating symmetry.
    
    Taking into consideration the results of the various array geometries the geometry shown in Appendix (a) with 5 arms was chosen for the new array design, this was due to two reason; firstly the array showed similar side-lobe levels to the 7 arm and 9 arm geometries but had fewer side-lobes, secondly with a desired inner radius of 25mm it would not be possible to fit more than 5 microphones easily. This design can also be seen in the finished design shown in Figure .
        
    Now with the desired design chosen further analysis was performed to ensure adequate performance from the array. Using the same technique shown in Section  producing a series of 2D Frequency responses through all the use-able frequencies to see a more accurate representation of the array response.  This was performed for both the 2D response of the Azimuth and Elevation as a 3D frequency response is essentially just a sum of the equations defining these, performing them separately provides similar results but the ability to see the response over the desired frequencies. Figure  shows the frequency response across the azimuth of the array ranging from 0 to 10kHz and Figure  showing the same frequency range across the elevation of the array.
        
        
                
        Final Array Azimuth Frequency Sweep Beam Patterns
                        
        
                
        Final Array Elevation Frequency Sweep Beam Patterns
                        
    As shown in both of the sweeping 2D frequency responses' the array has very minimal side-lobe levels from 686Hz through to 10kHz. Following Eqn.  with the array diameter of 1m it would equate to 686Hz being the lowest possible frequency to have directionality, this is verified when looking at the frequency response of the array. This relationship is due to spatial aliasing and the requirement for their two be two sensors within the wavelength of the signal as described in Section .
        
        
        









        
    Now that the design had been finalised and deemed appropriate for the MEMS microphones and use case it was modelled in Solidworks as can be seen in Figure  (a), due to the complex geometry of the design it was laser-cut out of 6mm plywood in four separate pieces and using wood glue to put them together. The design allows for the microphones to be screwed directly into their correct position with a much greater accuracy than when it was hand-made, this results in much tighter geometry tolerances and therefore higher accuracy when beamforming.

    A lot of considerations were made when modelling the array for the best possible performance, one of the biggest issues with microphone arrays is noise and conflicting signals causing interference with the expected signals generally known as reverberation, this results in conflicting information being returned by the array. To avoid the problems of reverberation as much of the array surface area between microphones was removed to avoid reverberation from sound bouncing back off of the wooden surface whilst still keeping enough structural rigidity. Around the whole array several small holes were cut out for easier cable management and a flat spot on the top for a spirit level as for accurate results the array must be level.

        
                
        Final Array
                    

Design Comparison 
    Below in Figure  a comparison of the first testing array and final design at 3kHz. As expected the final design has much lower side-lobe levels and smaller main-lobe giving the array higher resolution and a higher signal to noise ratio, a significant improvement over the original array. 
        
        
                
        Array Comparison 3D Responses
                        

Microphones     Before the wide availability of MEMS (MicroElectrical-Mechanical System) Microphones arrays were required to be set up with conventional analog microphones, this made the arrays very expensive, large and heavy, limiting the widespread availability of this technology with such a high barrier to entry without even considering the requirements for data acquisition. With the now every-growing mobile phone industry MEMS Microphones are incredibly cheap starting at less than a dollar each, this allows for large arrays to be built for very low costs. The SPW2430 MEMS microphones were selected for my array, they boast a flat frequency response between 100Hz and 10kHz making them a perfect pairing for the microphone array, they are cost efficient and can be bought directly from many local and international distributors on breakout boards that are able to be directly wired into the National Instrument hardware as they have an analog DC output that is easily digitized for analysis and post processing.

Data Acquisition 
First Array     The initial testing array consisted of 12 of the SPW2430 MEMS Microphones mounted on a large piece of cardboard. There were four NI 9232 C-series modules available for analog input into an NI cDAQ-9178 for data acquisition, at the time of the photos three of the c-series modules were being used for other projects. The NI 9232 C-series modules are designed for sound and vibration inputs and take in three signals each simultaneously, with built in anti-aliasing filters for the selected sample rates up to 102.4kHz per channel. The NI cDAQ-9178 allows for the data acquisition from the NI-9232 modules and the synchronisation of the acquired data across multiple modules, it communicates with a computer via a USB for plug-and-play simplicity. Figure  pictures the cDAQ and a single NI9232 wired in, showing a demonstration of how the components are put together.

    One of the most important outcomes taken from the initial testing of this array was the need for proper wiring, the wiring used can be seen in Figure  is a high gauge wire that comes with 3-wires in a flat ribbon with no shielding or way to prevent environmental electrical noise. This resulted in a lot of noise across all the channels and was something that was required to be changed for the next iteration.

    
                        NI cDAQ with a single NI 9232 Installed and Wired Up
            
Second Array     The second array was designed to be used with two NI cRIO-9036's Real Time Targets with FPGA's and 16 NI-9232 C-series Modules. This configuration would have allowed for up to 48 Channels of synchronised 102.4kHz input signals being processed on the cRIO's themselves with potential to move some processing to the FPGA. Due to unforeseen circumstances this hardware was made inaccessible and unavailable and a change of hardware was required. The hardware was changed back to the NI cDAQ-9178, now using 8 NI-9229's C Series Modules, this allows for up to 24 synchronous channels of 50kHz sample rate. Hence the final microphone array only consisted of 24 microphones with all processing taking place on an attached computer. As the array was designed for the use of 45 microphones spanning over 5 arms it had to be cut down, the inner 20 were microphones were chosen and then 4 of the 5 on the next ring of microphones as shown in Figure .
    
    
                        Final Microphone Array with 24 Microphones
            
    In attempt to prevent the problem of noise from the external electrical environment as was present in the initial design due to the choice of wiring for this design each microphone had two separate shielded twisted pair cables. This allowed for a single twisted pair for the signal going back to the data acquisition card and a single twisted pair going back to power for each microphone. Once the cables were properly shielded it resulted in a dramatic reduction in noise. Figure  shows the microphones all cabled and screwed in. 

    
                        Final Microphone Array Wiring
                
    A comparison of the intended final array and the tested final array is shown in Figure , the designed intended final array has a much better response as would be expected with almost double the microphones and much larger aperture, though the final microphone array has an adequate response and is still significantly better than the first tested design.
    
    
                
        Comparison of Frequency Responses at 3kHz
                

Application to Machine Defects 
Vibration analysis is used to evaluate the condition of machinery and determine whether defects due to misalignment, bearing degradation, looseness or any other potential factors are present. These defects generally cause vibration or impacting within the shaft or bearing housing that can be analysed and diagnosed, diagnosis requires the measurement of the vibration, velocity or displacement of the shaft or bearing housing over a period of time so that the time waveform and the frequency spectrum can be obtained and analysed. Instead of using an accelerometer to measure the vibration it is possible to use a microphone as these defects generate noise the same way they generate vibration, ideally with an array of microphones this will give the ability to pin-point certain defects of machinery using their frequency spectrum characteristics.

Focusing on the frequency spectrum as the features and patterns present can be directly related to those that would be picked up by a microphone array and therefore located. When analysing spectrums for defects there are various patterns and features to look out for that are typical of certain fault cases, some of these can be:


    Harmonic patterns
    Periodic events
    Sidebands
    Separation of close frequencies

Harmonic patterns are multiples of a specific frequency for example if there is a frequency at 25Hz it's harmonics would be 50Hz, 75Hz, 100Hz and so on. The first frequency (25Hz) is known as the fundamental frequency.
Harmonics can be synchronous, sub-synchronous or non-synchronous. Synchronous includes the running speed frequency and all of its harmonics, sub-synchronous is below the running speed frequency and non-synchronous are all the frequencies between harmonics, all of these can indicate different types of faults. Common reasons for synchronous energy in the spectrum is imbalance, misalignment, looseness, blade/vane pass frequencies or gears, for sub-synchronous energy is commonly due to other machinery, hydraulic instability, or cage frequencies of bearings and for non-synchronous energy energy is commonly due to rolling element bearing defects, resonances, cavitations or other components and machines.

Sidebands occur when there are two equally space frequencies on the higher and lower side of a frequency for example if there is a frequency a 125Hz and two more frequencies at 130Hz and 120Hz these two frequencies would be called sidebands, specifically 10Hz sidebands. A single frequency with sidebands in a time waveform would look like amplitude modulation, and if there are also harmonics with sidebands present this would look like amplitude modulation with a distorted fundamental carrier wave. Common reasons for the appearance of sidebands are gear tooth wear, gear backlash, motor rotor faults or bearing ball defects.

Knowing these common occurring defects of machinery that can be identified through the frequency spectrum with the addition of a microphone array beamforming with the MUSIC algorithm it is possible to determine locations of certain defects by targeting that particular set of frequencies, as well as this the sound can then be extracted from that location for further analysis. 


Testing 
Early Testing of First Design     Early testing using the first array design involved myself whistling in-front of the array, this did give promising results. For the final testing of the first design I was standing above the microphone array whistling while acquiring one second of data, using the delay and sum algorithm on this signal produced the heat-map shown in Figure . This result accurately estimated the sound source to be right at the top of the array in the centre which is accurate to where I was, also present are two relatively major side-lobes in the bottom right quadrant of the heat-map that are of significance for validating the result.
    
    
                        Result of Whistle testing
                
    After performing a Fourier transform on the signal it was found that my whistle frequency was 1675Hz this is information as well as its spatial location was required to test the result in simulation and 3D frequency response for verification. Knowing the location and the frequency a 3D Frequency response was setup with those parameters producing Figure . As can be this produced a very similar looking heat-map which would indicate that the algorithm and hardware are both working on the test array as that would be the only way to produce such similar results. The main-lobe and side-lobes all look nearly identical between the real test and the 3D Frequency Response.
    
    
                        Whistle test 3D Frequency Response
                
    To further validate the results from the test run the parameters were again used in the simulation. Figure  shows the results from this. Again showing the same and very promising results as the 3D Frequency response as was expected.
    
     
                        Whistle test Simulation
            
    This whistle test and following simulations validated the array design and that it was working with my delay and sum algorithm, though due to the external electrical noise in the wiring and the small number of microphones no more testing was performed or required and moving onto the design of a larger array and improved algorithms was the next step.
    

Final Design Testing     Before the final testing took place the array was tested to at the least be able to determine the correct side of the array a signal produced from a phone loud-speaker was arriving from, these results can be found in Appendix . Following the success of the array to estimate the correct general location of incoming signals further test cases as described in the following sections were carried out.

Design Verification     To verify the accuracy and performance of the microphone array testing was performed in the lab using a speaker and a laser distance measurer. There were two tests performed, one with a speaker at 70 Degrees Azimuth and the other with the speaker at 170 Degrees Azimuth from leftmost side of the array both at the centre of Elevation, these angles were calculated with basic trigonometry using the laser distance measurer, the 70 Degree test was 4m away from the origin of the array whilst the 170 Degree test was 3m from origin.

    Figure  displays the results of the delay-and-sum algorithm to both of the test, this algorithm was chosen for the purpose of verifying the array due to it being much less error prone than MUSIC with less need for user input and has previously been tested and shown to work with a real array. The results show that the array does indeed operate as expected as well as the algorithm. The 70 Degree test was close to exact along the azimuth and was estimated to be a few degrees above its true elevation. Inaccuracies begin to show at the edge of the array for the 170 Degree test with the azimuth estimation being around 10 Degrees off but the elevation estimation was as expected.
    
    If we refer back to Figure  the reason for the inaccuracies at the edge of the array can be explained, as the array is steered towards the edge the main-lobe of the 2D frequency response becomes larger in the exact same way as is seen in the 170 Degree test. This can be attributed all the way back to Eqn.  where it was determined that the time difference of arrival for signals is a cosine function and hence as the angle of arrival approaches either 0 or 180 Degrees the time difference of arrival between microphones becomes increasingly smaller and increasingly difficult to separate between angles creating the large main-lobes as steering towards the edges of the array as seen in Figure  and , this will occur in both the delay-and-sum and the MUSIC algorithm as it comes to the characteristics of sound waves. To show the difference between two points on an array results from two calculations using Eqn.  are shown in Table , this table shows the difference in the time difference of arrival when moving 1 degree across the azimuth towards centre from both 40 Degrees and 170 Degrees, the difference in time delay being much smaller when at 170 Degrees.

    
                1
        Array Time Delay Comparisons 
        
                
    
                
        Array Verification Test
                

Algorithm Comparison     The next stage of testing involved testing and comparing the accuracy of both the delay-and-sum and MUSIC algorithm by comparing the results to an identical sound source. Again using the laser distance measurer a speaker was placed at 47 Degrees Azimuth and centre of the Elevation playing a 1871Hz tone.

    For both of the results shown in Figure  the algorithms were using the exact same 0.1s snippet of sound, whilst the MUSIC algorithm just processed for the exact 1871Hz frequency required the delay and sum is required to process the full snippet. The delay and sum resulted in a 3 Degree accuracy to the true source location and the MUSIC algorithm resulted in a 2 Degree accuracy, the resolution of the MUSIC algorithm is much higher though as well as having a significantly lower noise and number of side-lobes present. As well as showing better resolution and accuracy the MUSIC algorithm was over 10 times as fast as the delay and sum algorithm further cementing its place for determine the location of specifically chosen frequencies.

    
                
        Real Algorithm Comparison to 1871Hz Signal
            

Defect Detection 
    Now to verify the ability of the array to differentiate different noise and spatially locate them a simple test was performed in a lab environment. To the right hand side 3m from the array a speaker was playing a loud 2.5kHz sinusoidal tone and in front of the array to the left 8m away was a turbine balance test rig running at 3000rpm, the purpose of the test was to see if it would be possible to differentiate the sources.

    Figure  shows the signals captured by the microphone array over a 4 second period. As can be seen in the frequency spectrum, there is a significant amount of noise in the sub 1kHz frequency range, a large spike at 2.5kHz, a small bunch of signals at 5kHz and 6kHz and more noise around 9-11kHz. As the noise in the lab was known the small peaks that appeared at 5kHz and 6kHz were assumed to be coming from the balancing test rig, Figure  provides a closer look at some of the assumed signals from the balancing test rig.
    
    
                        Microphone Signals
                
    
                        Zoomed Microphone Signals
                
    In the following Figure  it is shown that the array succeeded in differentiating the signal source locations and identified the correct locations for the signals. The color scale for the intensity map was changed for Figure  for less confusion when interpreting the result, instead of showing all side-lobes and the main-lobe this scale only shows the main lobe and highest side-lobes if they are present. In Figure (a) a single frequency of 2474Hz was searched for using the MUSIC algorithm and for Figure (b) a set of frequencies was used to search for, these being: 4812Hz, 4870Hz, 4921Hz, 6080Hz, and 6090Hz, these being the prominent signals that are present in Figure . As shown this method of differentiating signals by selecting certain frequencies worked well, the 2.5kHz signal was located  accurately though the estimated area is relatively large, on the other-hand the turbine balance test rig was estimated very precisely and accurately though there is a large number of side-lobes creating some uncertainty within the results though is expected when beamforming at higher frequencies. Impressively the array could pick out the turbine test rig using the particular frequencies even when they were barely above the noise floor of the environment.
    
    
                
        Differentiate signal testing results
                
    This test shows promising results with the array proving that is able to differentiate particular noise sources by frequency and even when the particular frequencies of interest are only just above the noise floor. As well this test has reinforced the potential of the microphone array for finding defects in machine by using a particular set of frequencies to pin-point spatially.


Site Testing 
    Site testing was conducted at a local power-station that had been experiencing issues with one of their steam-driven turbines. The turbine had been suffering from a hammering-like noise originating from an unknown source. The primary aims of this testing was first to evaluate the effectiveness of the array in a loud industrial environment with operating machinery and the second aim was to determine where the noise was originating from and what was causing it.
    
    Figure  shows an overview of the general turbine layout with labelled cylinders and bearings for future reference.

    
                        Typical 4 Cylinder Reheat Steam Turbine
            
    

    The array with it's 24 microphones was brought onto site and placed at various points of both of the turbine's Low Pressure Cylinders (LPB) close to where the noise was described to be originating from by the client. Data was taken from the unit generating the noise and then at the same locations on the a second unit that had not been generating the noise to provide a comparison of the noise characteristics of each unit. Measurements were taken at the casing between bearing's 8 and 9, in the middle of the LPB Cylinder and at the casing between bearing 6 and 7 to try and gain a full insight to the full soundscape of the LPB Cylinder. Pictures taken from the perspective of the microphone array of all these locations can be found in Appendix .

    Acquired Data 
    Firstly, looking at a comparison of the spectrums and waveforms received at both of the turbines. Figure  and  show the spectrum and time waveform of the bad and good turbines respectively. When comparing the signals look nearly identical, interestingly the good turbine was quite a bit louder than the bad turbine producing a much higher peak in the time waveform and frequency amplitudes in the spectrum. 

    The primary features of both spectrums is the series of harmonics, the fundamental frequency of both turbines is 50Hz as they are running at 3000rpm, hence the spectrum is filled with harmonics of the fundamental frequency, more specifically odd harmonics, 150Hz, 250Hz, 350Hz, etc. . 

    
                        Spectrum and Time Waveform Centre of LPB Problem Unit
            
    
                        Spectrum and Time Waveform Centre of LPB Good Unit
            
    Unfortunately testing did not go as well as I would have hoped, beamforming with the array was unable to locate any sound sources with delay and sum or even any individual or sets of frequencies using MUSIC. Figure  shows a comparison of the two turbines waveforms over a single period. 

    
                
        Turbine Single Period Comparison
                
    Both of the time waveforms shown in Figure  are very similar but there is one notable problem with both of these in regards to beamforming, there is absolutely no time difference of arrival between microphones, which is the basis that allows all beamforming to take place. This problem causes the array to estimate the sound source as originating from the exact center of the array. Figure  displays the results for beamforming with both the delay-and-sum and MUSIC algorithm at the center of the problem turbine's LPB cylinder. 
    
    
                
        Beamforming Results LPB Cylinder Problem Unit
                
    As expected the results in Figure  from beamforming with both algorithms returned similar results with estimated sound source being in the dead center of the array. This result was constant with all locations tested from both turbines, no matter the frequencies searched for using MUSIC, the estimated sound source was always in the dead center of the array.
    
    Looking at the signals in Figure  and  it would be assumed that the signals are indeed coming from directly in the centre of the array as all the signals are arriving at the same time, though due to the many different testing locations around the turbine floor and the signal being the same at all locations the sound cannot realistically be coming from a point directly in the centre of the array at all points unless of course the sound is coming from everywhere, there are two main thoughts as to the reasons this is happening. The first theory is that the cylinder itself and the bearing casings of the turbine are acting as one large loudspeaker, this would be amplifying the noise over the whole turbine, this fits the signal being synchronised on all microphones as the sound would be from directly in front of all microphones. The second theory is that due to the environment of the power station that the reverberation off of the surrounding structure and plant is causing the signal to be coming from all directions at once and hence the microphone signals all being synchronised.
    

Conclusion     
    
    
    The primary aims of this project were to build a working acoustic beamforming array that would be able to locate and detect particular sounds in noisy environments as well as being able to extract the signal from the particular location. Throughout this project I achieved all of these aims by building a working acoustic beamforming  array that successfully located individual sounds out of a noisy test environment, though unfortunately was not able to locate sounds in the testing performed on-site. 
    
    My research into the area of beamforming array provided great insight into audio and digital signal processing, with this and the aid of my learning in LabVIEW development I was able to evaluate many different geometries,  algorithms and processing methods using the software I developed for simulation and found the MUSIC algorithm as being the most suitable and applicable to the purpose of locating and identifying defects in machinery when used to find a particular or set of frequencies.
    
    Using the acoustic array I designed with the Underbrink equations I found it was very capable of locating individual sound sources out of a noisy environment using the MUSIC algorithm, by searching for an individual frequency or a set of frequencies, this was shown by accurately differentiating and locating both a small turbine test-rig and speaker that were running simultaneously. Disappointingly the acoustic array when tested on in-service turbines at a local power-station was unable to beamform effectively at any location on the turbine-floor, this is thought to be due to either the whole casing of the turbine acting as a loud-speaker, an overwhelming amount of reverberation or a combination of both.
    
    In conclusion, with further testing on more and different plant as well as in different environments that this acoustic array could be used for the purpose of identifying and locating defects on machinery with further fine-tuning, refinement and understanding of sound propagation in industrial environments.

harvard
 

[figure]list=no
Time Log Graphic
    
                        Harvest Time Visualisation
    
Reflection
    
    
    I commenced my engineering degree at University of Newcastle immediately after leaving school, beginning my time here with entirely different skills, abilities and attributes.
    
    Through my last four and a half years studying Mechanical Engineering/Business and through the my Industrial Experience at Verico Asset Integrity Services as well as employment I have a completely renewed idea of what engineering truly involves. My time study engineering has taught me methods on how to think critically, parse large amounts of information efficiently and effectively as well as a great conceptual and in-depth understanding of a broad range of topics within mechanical and engineering in general.
    
    My professional and personal attributes through this time have completely evolved, starting out, my standards for professional writing, time/self management and effective team work were minuscule compared to what they are now. Through courses like MECH2110, MECH4580, and my Final Year Project my skills in these "soft" skills have developed exceptionally, I now feel confident in holding myself to a professional standard in terms of ethics, communications, research and design, self management and team management in all areas of work.
    
    
Simulation Figures     
                        Array of signals when Steered to the Centre of the Array
        
                        Array of signals at Centre Summed and Normalised
        
                        Array of signals when Steered to the Source Location
        
                        Array of signals at Source Location Summed and Normalised
    
Geometry Investigation Geometries     
        
    Series of tested microphone array geometries
        Frequency Responses    
        
    3D Frequency Response Results
        
Testing Figure 
        
    Initial Calibration Results
        Site Testing Locations     
                        Problem Unit Bearing 8
        
                        Problem Unit Bearing 8 Angle 2
        
                        Problem Unit Bearing 7
        
                        Problem Unit LPB Cylinder
        
                        Good Unit LPB Bearing 8
        
                        Good Unit LPB Cylinder
    
